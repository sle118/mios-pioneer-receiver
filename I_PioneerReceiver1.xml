<?xml version="1.0"?>
<implementation>
    <settings>
        <protocol>cr</protocol>
    </settings>

    <functions>
    local p
	
	function startup(lul_device)
		luup.log("Pioneer plugin: loading library L_Pioneer1 ...")
		if (package.path:find ("/etc/cmh-ludl/?.lua;/etc/cmh-lu/?.lua", 1, true) == nil) then
			package.path = package.path .. ";/etc/cmh-ludl/?.lua;/etc/cmh-lu/?.lua"
		end

		package.loaded.L_PioneerReceiver1 = nil
		p = require("L_PioneerReceiver1")
		if (package.loaded.L_PioneerReceiver1 == nil)
		then
			luup.log("PioneerReceiver plugin: plugin is not installed correctly. Library L_PioneerReceiver1 cannot be loaded.", 1)
			luup.task("Plugin not correctly installed", 2, "PioneerReceiver plugin", -1)
			return false
		end

		luup.log("PioneerReceiver plugin: library L_PioneerReceiver1 loaded")

		return p.startup(lul_device)
	end
        
    </functions>

    -- -------------------------------------------------------------------------
    <incoming>
        <lua>
            local response = tostring(lul_data)
            luup.log("Response:" .. response)	
        </lua>
    </incoming>

    <startup>startup</startup>

    <actionList>
        <action>
            <serviceId>urn:micasaverde-com:serviceId:PioneerReceiver1</serviceId>
            <name>MyAction</name>
            <job>
                local actionParm = lul_settings.ActionParm
                if (actionParm ~= nil) then
					-- do stuff here for the job
					luup.log("Pioneer plugin: MyAction "..actionParm )
                end
				-- return status
				--job_None=-1, // no icon
				--job_WaitingToStart=0, // gray icon
				--job_InProgress=1, // blue icon
				--job_Error=2, // red icon
				--job_Aborted=3, // red icon
				--job_Done=4, // green icon
				--job_WaitingForCallback=5 // blue icon - Special case used in certain derived classes
                return 4,0
            </job>
        </action>	
        <action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
            <name>DiscreteinputCable</name>
            <run>
                doAction("InputSelection1", "DiscreteinputCable")
            </run>
        </action>
        
        <action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
            <name>DiscreteinputCD1</name>
            <run>
                doAction("InputSelection1", "DiscreteinputCD1")
            </run>
        </action>
        
        <action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
            <name>DiscreteinputCD2</name>
            <run>
                doAction("InputSelection1", "DiscreteinputCD2")
            </run>
        </action>
        
        <action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
            <name>DiscreteinputCDR</name>
            <run>
                doAction("InputSelection1", "DiscreteinputCDR")
            </run>
        </action>

        <action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
            <name>DiscreteinputDAT</name>
            <run>
                doAction("InputSelection1", "DiscreteinputDAT")
            </run>
        </action>
        
        <action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
            <name>DiscreteinputDVD</name>
            <run>
                doAction("InputSelection1", "DiscreteinputDVD")
            </run>
        </action>

        <action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
            <name>DiscreteinputDVI</name>
            <run>
                doAction("InputSelection1", "DiscreteinputDVI")
            </run>
        </action>

        <action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
            <name>DiscreteinputHDTV</name>
            <run>
                doAction("InputSelection1", "DiscreteinputHDTV")
            </run>
        </action>

        <action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
            <name>DiscreteinputLD</name>
            <run>
                doAction("InputSelection1", "DiscreteinputLD")
            </run>
        </action>
		
        <action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
            <name>DiscreteinputMD</name>
            <run>
                doAction("InputSelection1", "DiscreteinputMD")
            </run>
        </action>

        <action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
            <name>DiscreteinputPC</name>
            <run>
                doAction("InputSelection1", "DiscreteinputPC")
            </run>
        </action>
        
        <action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
            <name>DiscreteinputPVR</name>
            <run>
                doAction("InputSelection1", "DiscreteinputPVR")
            </run>
        </action>

        <action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
            <name>DiscreteinputTV</name>
            <run>
                doAction("InputSelection1", "DiscreteinputTV")
            </run>
        </action>

        <action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
            <name>DiscreteinputVCR</name>
            <run>
                doAction("InputSelection1", "DiscreteinputVCR")
            </run>
        </action>
		
		<action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
		    <name>Input1</name>
            <run>
                doAction("InputSelection1", "Input1")
            </run>
		</action>
		
		<action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
		    <name>Input2</name>
            <run>
                doAction("InputSelection1", "Input2")
            </run>
		</action>
		
		<action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
		    <name>Input3</name>
            <run>
                doAction("InputSelection1", "Input3")
            </run>
		</action>
		
		<action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
		    <name>Input4</name>
            <run>
                doAction("InputSelection1", "Input4")
            </run>
		</action>
		
		<action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
		    <name>Input5</name>
            <run>
                doAction("InputSelection1", "Input5")
            </run>
		</action>
		
		<action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
		    <name>Input6</name>
            <run>
                doAction("InputSelection1", "Input6")
            </run>
		</action>
		
		<action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
		    <name>Input7</name>
            <run>
                doAction("InputSelection1", "Input7")
            </run>
		</action>
		
		<action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
		    <name>Input8</name>
            <run>
                doAction("InputSelection1", "Input8")
            </run>
		</action>
		
		<action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
		    <name>Input9</name>
            <run>
                doAction("InputSelection1", "Input9")
            </run>
		</action>
        
        <action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
            <name>Input10</name>
            <run>
                doAction("InputSelection1", "Input10")
            </run>
        </action>
		
		<action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
		    <name>Source</name>
            <run>
                doAction("InputSelection1", "Source")
            </run>
		</action>

		<action>
            <serviceId>urn:micasaverde-com:serviceId:InputSelection1</serviceId>
		    <name>ToggleInput</name>
            <run>
                doAction("InputSelection1", "ToggleInput")
            </run>
		</action>

        <action>
            <serviceId>urn:micasaverde-com:serviceId:DiscretePower1</serviceId>
            <name>Off</name>
            <run>
                doAction("DiscretePower1", "Off")
            </run>
        </action>

        <action>
            <serviceId>urn:micasaverde-com:serviceId:DiscretePower1</serviceId>
            <name>On</name>
            <run>
                doAction("DiscretePower1", "On")
            </run>
        </action>

        <action>
            <serviceId>urn:micasaverde-com:serviceId:MenuNavigation1</serviceId>
            <name>Back</name>
            <run>
                doAction("MenuNavigation1", "Back")
            </run>
        </action>

        <action>
            <serviceId>urn:micasaverde-com:serviceId:MenuNavigation1</serviceId>
            <name>Down</name>
            <run>
                doAction("MenuNavigation1", "Down")
            </run>
        </action>

        <action>
            <serviceId>urn:micasaverde-com:serviceId:MenuNavigation1</serviceId>
            <name>Exit</name>
            <run>
                doAction("MenuNavigation1", "Exit")
            </run>
        </action>

        <action>
            <serviceId>urn:micasaverde-com:serviceId:MenuNavigation1</serviceId>
            <name>Left</name>
            <run>
                doAction("MenuNavigation1", "Left")
            </run>
        </action>

        <action>
            <serviceId>urn:micasaverde-com:serviceId:MenuNavigation1</serviceId>
            <name>Menu</name>
            <run>
                doAction("MenuNavigation1", "Menu")
            </run>

        </action>

        <action>
            <serviceId>urn:micasaverde-com:serviceId:MenuNavigation1</serviceId>
            <name>Right</name>
            <run>
                doAction("MenuNavigation1", "Right")
            </run>
        </action>

        <action>
            <serviceId>urn:micasaverde-com:serviceId:MenuNavigation1</serviceId>
            <name>Select</name>
            <run>
                doAction("MenuNavigation1", "Select")
            </run>
        </action>

        <action>
            <serviceId>urn:micasaverde-com:serviceId:MenuNavigation1</serviceId>
            <name>Up</name>
            <run>
                doAction("MenuNavigation1", "Up")
            </run> 
       </action>
        <action>
            <serviceId>urn:micasaverde-com:serviceId:Volume1</serviceId>
            <name>Down</name>
            <run>
                doAction("Volume1", "Down")
            </run>
        </action>

        <action>
            <serviceId>urn:micasaverde-com:serviceId:Volume1</serviceId>
            <name>Mute</name>
            <run>
                doAction("Volume1", "Mute")
            </run>
        </action>

        <action>
            <serviceId>urn:micasaverde-com:serviceId:Volume1</serviceId>
            <name>Up</name>
            <run>
                doAction("Volume1", "Up")
            </run>
        </action>
    </actionList>
</implementation>
